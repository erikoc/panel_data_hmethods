Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
KSS.fit <- KSS(l.gdp.dy ~ dem.dy.2 + dplyr::lag(l.gdp.dy, 1) + dplyr::lag(l.gdp.dy, 2) + dplyr::lag(l.gdp.dy, 3) + dplyr::lag(l.gdp.dy, 4) - 1,
additive.effects = "twoways", consult.dim.crit = TRUE)
l.gdp.dy <- matrix(AER$lgdp, T, n)
dem.dy.2 <- matrix(AER$dem, T, n)
KSS.fit <- KSS(l.gdp.dy ~ dem.dy.2 + dplyr::lag(l.gdp.dy, 1) + dplyr::lag(l.gdp.dy, 2) + dplyr::lag(l.gdp.dy, 3) + dplyr::lag(l.gdp.dy, 4) - 1,
additive.effects = "twoways", consult.dim.crit = TRUE)
summary(KSS.fit)
KSS.fit <- KSS(l.gdp.dy ~ dem.dy.2 + dplyr::lag(l.gdp.dy, 1) + dplyr::lag(l.gdp.dy, 2) + dplyr::lag(l.gdp.dy, 3) + dplyr::lag(l.gdp.dy, 4) - 1,
additive.effects = "twoways", consult.dim.crit = TRUE)
summary(KSS.fit)
country_list <- split(AER, AER$id)
KSSdyWrapper <- function(data_list, indices) {
d <- do.call(rbind, data_list[indices])
l.gdp.dy <- matrix(d$lgdp, T, n)
dem.dy.2 <- matrix(d$dem, T, n)
KSS.fit <- KSS(l.gdp.dy ~ dem.dy.2 + dplyr::lag(l.gdp.dy, 1) + dplyr::lag(l.gdp.dy, 2) + dplyr::lag(l.gdp.dy, 3) + dplyr::lag(l.gdp.dy, 4) - 1,
additive.effects = "twoways", factor.dim = 4)
return(KSS.fit$slope.para)
}
boot_results_KSSdy <- boot(country_list, KSSdyWrapper, R = 1000, stype = "i")
boot_cis <- lapply(1:5, function(i) boot.ci(boot.out = boot_results_KSSdy, index = i, type = c("norm", "perc", "bca")))
boot_cis
boot_results_KSSdy
n <- as.numeric(length(unique(complete_data_static$wbcode)))
T <- as.numeric(length(unique(complete_data_static$year)))
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
n <- as.numeric(length(unique(complete_data_static$wbcode)))
T <- as.numeric(length(unique(complete_data_static$year)))
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "PC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
OptDim(Eup.fit)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
n <- as.numeric(length(unique(complete_data_static$wbcode)))
T <- as.numeric(length(unique(complete_data_static$year)))
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IPC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
optim(Eup.fit)
OptDim(Eup.fit)
n <- as.numeric(length(unique(complete_data_static$wbcode)))
T <- as.numeric(length(unique(complete_data_static$year)))
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IPC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
n <- as.numeric(length(unique(complete_data_static$wbcode)))
T <- as.numeric(length(unique(complete_data_static$year)))
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "PC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IPC1")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
d.l.gdp <- diff(log(matrix(complete_data_static$gdp, T, n)))
d.dem <- matrix(complete_data_static$dem[-1], T-1, n)
d.l.capital <- diff(log(matrix(complete_data_static$k, T, n)))
d.l.inv <- diff(log(matrix(complete_data_static$i, T, n)))
d.l.hc <- diff(log(matrix(complete_data_static$hc, T, n)))
d.l.gvt <- diff(log(matrix(complete_data_static$g, T, n)))
d.l.lifeexp <- diff(log(matrix(complete_data_static$lifeexp, T, n)))
d.l.trade <- diff(log(matrix(complete_data_static$x + complete_data_static$m , T, n)))
Eup.fit <- Eup(d.l.gdp ~  d.dem + dplyr::lag(d.l.gdp, 1) + dplyr::lag(d.l.gdp, 2) + dplyr::lag(d.l.gdp, 3) + dplyr::lag(d.l.gdp, 4) + d.l.inv + d.l.capital + d.l.gvt + + d.l.hc + d.l.lifeexp + d.l.trade  -1,
additive.effects = "twoways", dim.criterion = "IPC2")
checkSpecif(Eup.fit, level = 0.01)
summary(Eup.fit, error.type = 5)
OptDim(Eup.fit)
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", factor.dim = 0)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
l.gdp.dy <- matrix(AER$lgdp, T, n)
dem.dy.2 <- matrix(AER$dem, T, n)
KSS.fit <- KSS(l.gdp.dy ~ dem.dy.2 + dplyr::lag(l.gdp.dy, 1) + dplyr::lag(l.gdp.dy, 2) + dplyr::lag(l.gdp.dy, 3) + dplyr::lag(l.gdp.dy, 4) - 1,
additive.effects = "twoways", consult.dim.crit = TRUE)
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
AER <- read.dta13("democracy-balanced-l4.dta")
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", factor.dim = 0)
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.2)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
to_keep_acemoglu <- c("wbcode", "dem", "year", "y")
democracy_data <- read_democracy_data(".\\acemoglu_democracy.dta", to_keep_acemoglu)
library(lmtest)
library(boot)
library(phtt)
source("data_management_fn.R")
to_keep_acemoglu <- c("wbcode", "dem", "year", "y")
democracy_data <- read_democracy_data(".\\acemoglu_democracy.dta", to_keep_acemoglu)
to_keep_wdi <- c("wbcode", "year", "lifeexp")
wdi_data <- read_wdi_data("SP.DYN.LE00.IN", 1960, 2009, to_keep_wdi)
keep_pwt1001 <- c("year", "countrycode", "pop", "rgdpna", "rnna", "rtfpna", "hc")
keep_pwt1001_na <- c("year", "countrycode", "q_c", "q_i", "q_g", "q_x", "q_m", "q_gdp", "q_gfcf", "xr2")
to_convert <- c("q_c", "q_i", "q_g", "q_x", "q_m", "q_gdp", "q_gfcf")
pwt_data <- read_pwt_data2(".\\pwt1001.xlsx", ".\\pwt1001_na_data.xlsx", 3, keep_pwt1001, keep_pwt1001_na, to_convert)
merged_data <- merge(x = merge(pwt_data, democracy_data, by = c("wbcode", "year")), y = wdi_data, by = c("wbcode", "year"))
variables <- c("gdp", "k", "i", "g", "x", "m", "hc", "lifeexp", "dem")
threshold_year <- 1987
complete_data_static <- filter_and_print(merged_data, threshold_year, variables)
merged_data$year
unique(merged_data$year)
# 1. Fixed effects, no differences
complete_data_static$l.gdp <- log(complete_data_static$gdp)
complete_data_static$l.k <- log(complete_data_static$k)
complete_data_static$l.inv <- log(complete_data_static$i)
complete_data_static$l.hc <- log(complete_data_static$hc)
complete_data_static$l.g <- log(complete_data_static$g)
complete_data_static$l.lifeexp <- log(complete_data_static$lifeexp)
complete_data_static$l.trade <- log(complete_data_static$x + complete_data_static$m)
plm_complete_static <- pdata.frame(complete_data_static, index = c("wbcode","year"))
fe.fit    <- plm(l.gdp ~ dem + plm::lag(l.gdp, 1:4) + l.k + l.inv + l.hc + l.g + l.lifeexp + l.trade, plm_complete_static, model = "within", effect = "twoways", index = c("wbcode","year"))
fe.robust <- coeftest(fe.fit , vcov = vcovHC(fe.fit, cluster = 'group'))
fe.robust
# 1.2 Fixed effects, with differences
complete_data_static_diff <- complete_data_static %>%
group_by(wbcode) %>%
mutate(dlgdp = c(NA, diff(l.gdp))) %>%
ungroup()
complete_data_static_diff <- complete_data_static_diff %>%
filter(!is.na(dlgdp))
plm_complete_static_diff <- pdata.frame(complete_data_static_diff, index = c("wbcode","year"))
fe.fit    <- plm(l.gdp ~ dem + plm::lag(l.gdp, 1:4) + l.k + l.inv + l.hc + l.g + l.lifeexp + l.trade, plm_complete_static_diff, model = "within", effect = "twoways", index = c("wbcode","year"))
fe.robust <- coeftest(fe.fit , vcov = vcovHC(fe.fit, cluster = 'group'))
fe.robust
complete_data_static$l.gdp <- log(complete_data_static$gdp)
complete_data_static$l.k <- log(complete_data_static$k)
complete_data_static$l.inv <- log(complete_data_static$i)
complete_data_static$l.hc <- log(complete_data_static$hc)
complete_data_static$l.g <- log(complete_data_static$g)
complete_data_static$l.lifeexp <- log(complete_data_static$lifeexp)
complete_data_static$l.trade <- log(complete_data_static$x + complete_data_static$m)
plm_complete_static <- pdata.frame(complete_data_static, index = c("wbcode","year"))
fe.fit    <- plm(l.gdp ~ dem  + l.k + l.inv + l.hc + l.g + l.lifeexp + l.trade, plm_complete_static, model = "within", effect = "twoways", index = c("wbcode","year"))
fe.robust <- coeftest(fe.fit , vcov = vcovHC(fe.fit, cluster = 'group'))
fe.robust
complete_data_static_diff <- complete_data_static %>%
group_by(wbcode) %>%
mutate(dlgdp = c(NA, diff(l.gdp))) %>%
ungroup()
complete_data_static_diff <- complete_data_static_diff %>%
filter(!is.na(dlgdp))
plm_complete_static_diff <- pdata.frame(complete_data_static_diff, index = c("wbcode","year"))
fe.fit    <- plm(l.gdp ~ dem + l.k + l.inv + l.hc + l.g + l.lifeexp + l.trade, plm_complete_static_diff, model = "within", effect = "twoways", index = c("wbcode","year"))
fe.robust <- coeftest(fe.fit , vcov = vcovHC(fe.fit, cluster = 'group'))
fe.robust
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
library(lmtest)
library(boot)
library(phtt)
source("data_management_fn.R")
AER <- read.dta13("democracy-balanced-l4.dta")
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "IPC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
n <- as.numeric(length(unique(AER$id)))
T <- as.numeric(length(unique(AER$year)))
lgdp.dy <- diff(matrix(AER$lgdp, T, n))
dem.dy <- matrix(AER$dem[-1], T-1, n)
Eup.fit.1 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.2 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2)  - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.3 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.fit.4 <- Eup(lgdp.dy ~ dem.dy + dplyr::lag(lgdp.dy, 1) + dplyr::lag(lgdp.dy, 2) + dplyr::lag(lgdp.dy, 3) + dplyr::lag(lgdp.dy, 4) - 1,
additive.effects = "twoways", dim.criterion = "PC1")
Eup.sum1 <-summary(Eup.fit.1, error.type = 5)
print(Eup.sum1)
Eup.sum2 <-summary(Eup.fit.2, error.type = 5)
print(Eup.sum2)
Eup.sum3 <-summary(Eup.fit.3, error.type = 5)
print(Eup.sum3)
Eup.sum4 <-summary(Eup.fit.4, error.type = 5)
print(Eup.sum4)
plot(Eup.sum4)
OptDim(Eup.fit.4)
OptDim(Eup.fit.3)
OptDim(Eup.fit.2)
OptDim(Eup.fit.1)
